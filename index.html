<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Puchus Budget</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="bg-slate-200 text-slate-900 antialiased h-screen overflow-hidden">
  <div class="max-w-md sm:max-w-5xl mx-auto px-3 sm:px-4 py-3 sm:py-4 h-full flex flex-col">

    <div class="flex justify-center mb-3 shrink-0">
      <div class="flex w-full sm:w-auto rounded-full bg-slate-50 border border-slate-300 shadow-sm overflow-hidden">
        <button type="button" class="tab-btn flex-1 text-center px-4 py-2 text-xs sm:text-sm font-medium" data-tab-target="inputCard">Add +</button>
        <button type="button" class="tab-btn flex-1 text-center px-4 py-2 text-xs sm:text-sm font-medium" data-tab-target="tableCard">Transactions</button>
        <button type="button" class="tab-btn flex-1 text-center px-4 py-2 text-xs sm:text-sm font-medium" data-tab-target="reportCard">Report</button>
      </div>
    </div>

    <div class="bg-white rounded-2xl shadow-xl border border-slate-300 p-4 sm:p-6 flex-1 flex flex-col overflow-hidden mb-2">
      
      <header class="shrink-0 mb-3 sm:mb-4">
        <div class="flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between">
          <h1 class="text-lg sm:text-2xl font-semibold tracking-tight">Puchus Budget</h1>
          <div class="grid grid-cols-2 gap-2 sm:gap-3 sm:min-w-[260px]">
            <div>
              <label for="budgetMonthYear" class="block text-[10px] font-medium text-slate-600 mb-0.5">Month / Year</label>
              <input id="budgetMonthYear" type="month" class="w-full rounded-lg border border-slate-300 px-2.5 py-1 text-sm focus:ring-1 focus:ring-emerald-500 outline-none" />
            </div>
            <div>
              <label for="budgetAmount" class="block text-[10px] font-medium text-slate-600 mb-0.5">Monthly budget</label>
              <input id="budgetAmount" type="number" step="0.01" placeholder="1500" class="w-full rounded-lg border border-slate-300 px-2.5 py-1 text-sm focus:ring-1 focus:ring-emerald-500 outline-none" />
            </div>
          </div>
        </div>
      </header>

      <div class="flex-1 flex flex-col min-h-2 overflow-hidden space-y-3">
        
        <section id="inputCard" class="shrink-0 bg-slate-50 rounded-xl border border-slate-200 p-3 sm:p-4">
          <div class="mb-3">
            <p id="monthHeaderPrimary" class="flex items-baseline justify-between gap-2 text-sm font-semibold text-slate-900"><span>Total $0.00</span><span class="text-[11px] font-normal text-slate-500">0 transactions</span></p>
            <p id="monthHeaderSecondary" class="text-[11px] text-slate-600">Available budget: $0.00</p>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-5 gap-2 sm:gap-3 mb-3">
            <div class="md:col-span-1"><label class="block text-[10px] font-medium text-slate-600 mb-0.5">Date</label><input id="trxDate" type="date" class="w-full rounded-lg border border-slate-300 px-2 py-1 text-sm" /></div>
            <div class="md:col-span-2"><label class="block text-[10px] font-medium text-slate-600 mb-0.5">Description</label><input id="trxDesc" type="text" placeholder="Description..." class="w-full rounded-lg border border-slate-300 px-2 py-1 text-sm" /></div>
            <div><label class="block text-[10px] font-medium text-slate-600 mb-0.5">Category</label>
              <div class="relative"><button id="categoryBtn" type="button" class="w-full rounded-lg border border-slate-300 px-3 py-1 bg-white flex justify-between items-center text-sm"><span id="categorySelected">Select category</span><span>▾</span></button>
                <div id="categoryMenu" class="absolute left-0 right-0 mt-1 bg-white border border-slate-200 rounded-lg shadow-lg hidden z-20 max-h-48 overflow-y-auto">
                  <div class="category-item p-2 text-xs hover:bg-slate-100 cursor-pointer" data-cat="Groceries">Groceries</div>
                  <div class="category-item p-2 text-xs hover:bg-slate-100 cursor-pointer" data-cat="Dining out">Dining out</div>
                  <div class="category-item p-2 text-xs hover:bg-slate-100 cursor-pointer" data-cat="Personal spending">Personal spending</div>
                  <div class="category-item p-2 text-xs hover:bg-slate-100 cursor-pointer" data-cat="Housing">Housing</div>
                  <div class="category-item p-2 text-xs hover:bg-slate-100 cursor-pointer" data-cat="Transportation">Transportation</div>
                  <div class="category-item p-2 text-xs hover:bg-slate-100 cursor-pointer" data-cat="Subscriptions">Subscriptions</div>
                  <div class="category-item p-2 text-xs hover:bg-slate-100 cursor-pointer" data-cat="Health">Health</div>
                  <div class="category-item p-2 text-xs hover:bg-slate-100 cursor-pointer" data-cat="Utilities">Utilities</div>
                  <div class="category-item p-2 text-xs hover:bg-slate-100 cursor-pointer" data-cat="Savings">Savings</div>
                  <div class="category-item p-2 text-xs hover:bg-slate-100 cursor-pointer" data-cat="Miscellaneous">Miscellaneous</div>
                </div>
              </div>
            </div>
            <div><label class="block text-[10px] font-medium text-slate-600 mb-0.5">Amount</label><input id="trxAmount" type="number" step="0.01" class="w-full rounded-lg border border-slate-300 px-2 py-1 text-sm" /></div>
          </div>
<div class="flex flex-col sm:flex-row items-center gap-3">
  <div class="flex items-center gap-3 w-full sm:w-auto">
    <div id="accountToggle" class="inline-flex rounded-full border border-slate-300 bg-slate-50 p-0.5 text-xs">
      <button type="button" data-account="Ayush" class="px-3 py-1 rounded-full">Ayush</button>
      <button type="button" data-account="Joint" class="px-3 py-1 rounded-full">Joint</button>
      <button type="button" data-account="Nupur" class="px-3 py-1 rounded-full">Nupur</button>
    </div>

    <label class="flex items-center gap-2 cursor-pointer select-none">
      <input type="checkbox" id="trxRecurring" class="w-4 h-4 rounded border-slate-300 text-emerald-700 focus:ring-emerald-500">
      <span class="text-[11px] font-medium text-slate-500 uppercase tracking-tight">Recurring?</span>
    </label>
  </div>

  <button id="addTransactionBtn" class="w-full sm:w-auto sm:ml-auto rounded-xl bg-emerald-700 px-6 py-2 text-sm font-semibold text-white shadow-sm hover:bg-emerald-800 transition">
    Add
  </button>
</div>
        </section>

        <section id="tableCard" class="hidden flex-1 flex flex-col min-h-0 overflow-hidden bg-slate-50 rounded-xl border border-slate-200">
<div class="shrink-0 border-b border-slate-200 px-4 py-2 bg-slate-50/50">
  <p id="tableHeaderPrimary" class="flex items-baseline justify-between text-sm font-semibold">
    <span>Total $4300.49</span>
    <span class="ml-auto text-[11px] sm:text-xs font-normal text-slate-500">41 transactions</span>
  </p>

  <!-- NEW: over/available budget line (matches the Add tab behavior) -->
  <p id="tableHeaderSecondary" class="text-[11px] text-slate-600">Available budget: —</p>
</div>

          <div class="flex-1 overflow-auto">
            <table class="min-w-full text-xs">
              <thead class="bg-slate-100 sticky top-0 z-10">
                <tr class="text-left">
                  <th class="px-3 py-2 font-medium relative">
                    <button id="dateHeaderFilterBtn" class="flex items-center">Date<span id="dateHeaderFilterDot" class="w-1.5 h-1.5 rounded-full opacity-0 ml-1"></span></button>
                    <div id="accountFilterMenu" class="absolute left-0 mt-1 w-32 bg-white border rounded-lg shadow-lg hidden py-1 z-20">
                      <label class="flex items-center px-3 py-1 hover:bg-slate-50"><input type="checkbox" data-filter-multi="All" class="mr-2"> All</label>
                      <label class="flex items-center px-3 py-1 hover:bg-slate-50"><input type="checkbox" data-filter-multi="Ayush" class="mr-2"> Ayush</label>
                      <label class="flex items-center px-3 py-1 hover:bg-slate-50"><input type="checkbox" data-filter-multi="Joint" class="mr-2"> Joint</label>
                      <label class="flex items-center px-3 py-1 hover:bg-slate-50"><input type="checkbox" data-filter-multi="Nupur" class="mr-2"> Nupur</label>
                    </div>
                  </th>
                  <th class="px-3 py-2 font-medium">Description</th>
                  <th class="px-3 py-2 font-medium relative">
                    <button id="categoryHeaderFilterBtn">Category</button>
                    <div id="categoryFilterMenu" class="absolute left-0 mt-1 w-40 bg-white border rounded-lg shadow-lg hidden py-1 z-20">
                      <label class="flex items-center px-3 py-1 hover:bg-slate-50"><input type="checkbox" data-cat-filter-multi="All" class="mr-2" checked> All</label>
                    </div>
                  </th>
                  <th class="px-3 py-2 font-medium text-right">Amount</th>
                </tr>
              </thead>
              <tbody id="transactionsTableBody" class="divide-y divide-slate-100 bg-white"></tbody>
            </table>
          </div>
        </section>

        <section id="reportCard" class="hidden flex-1 flex flex-col min-h-0 overflow-hidden bg-slate-50 rounded-xl border border-slate-200 p-4">
          <div class="shrink-0 flex items-center justify-between mb-2">
            <h2 class="text-sm font-semibold">Spending Flow</h2>
            <p class="text-[10px] text-slate-500">Tap a node to filter items</p>
          </div>
          
          <div id="reportSankey" class="flex-1 min-h-0 w-full"></div>

          <div id="reportDetails" class="shrink-0 border-t border-slate-200 pt-3 max-h-[25%] overflow-y-auto min-h-0 bg-slate-50">
            <p class="text-[11px] text-slate-500 italic">Click a category above to view line items.</p>
          </div>
        </section>

      </div>
    </div>
  </div>

  <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
  <script src="script.js"></script>

<div id="deleteOverlay" class="fixed inset-0 bg-slate-900/40 flex items-center justify-center z-50 hidden backdrop-blur-[1px]">
  <div class="bg-white rounded-xl shadow-xl border border-slate-200 max-w-sm w-[90%] p-5">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-sm font-bold text-slate-900 uppercase tracking-tight">Edit Transaction</h3>
      <button id="deleteConfirmBtn" class="text-[10px] font-bold text-rose-600 uppercase tracking-wider hover:bg-rose-50 px-2 py-1 rounded">Delete</button>
    </div>
    
    <div class="space-y-3 mb-4">
      <div class="flex gap-2">
        <div class="flex-1">
          <label class="text-[10px] font-medium text-slate-500 mb-1 block">Date</label>
          <input type="date" id="editDate" class="w-full text-xs border rounded-lg p-2 outline-none focus:ring-1 focus:ring-slate-400">
        </div>
        <div class="w-24">
          <label class="text-[10px] font-medium text-slate-500 mb-1 block">Amount</label>
          <input type="number" id="editAmt" step="0.01" class="w-full text-xs border rounded-lg p-2 font-bold outline-none focus:ring-1 focus:ring-slate-400">
        </div>
      </div>
      <div>
        <label class="text-[10px] font-medium text-slate-500 mb-1 block">Description</label>
        <input type="text" id="editDesc" class="w-full text-xs border rounded-lg p-2 outline-none focus:ring-1 focus:ring-slate-400">
      </div>
      <div>
        <label class="text-[10px] font-medium text-slate-500 mb-1 block">Category</label>
        <select id="editCat" class="w-full text-xs border rounded-lg p-2 outline-none focus:ring-1 focus:ring-slate-400 bg-white">
          <option value="Groceries">Groceries</option><option value="Dining out">Dining out</option>
          <option value="Personal spending">Personal spending</option><option value="Housing">Housing</option>
          <option value="Transportation">Transportation</option><option value="Subscriptions">Subscriptions</option>
          <option value="Utilities">Utilities</option><option value="Savings">Savings</option>
          <option value="Health">Health</option><option value="Miscellaneous">Miscellaneous</option>
          <option value="Uncategorized">Uncategorized</option>
        </select>
      </div>
      
      <div class="flex items-center justify-between pt-2">
        <div id="editAccountToggle" class="inline-flex rounded-full border border-slate-300 bg-slate-50 p-0.5 text-[10px]">
          <button type="button" data-edit-account="Ayush" class="px-3 py-1 rounded-full">Ayush</button>
          <button type="button" data-edit-account="Joint" class="px-3 py-1 rounded-full">Joint</button>
          <button type="button" data-edit-account="Nupur" class="px-3 py-1 rounded-full">Nupur</button>
        </div>
        <label class="flex items-center gap-2 cursor-pointer select-none">
          <input type="checkbox" id="editRecurring" class="w-3.5 h-3.5 rounded border-slate-300 text-emerald-700">
          <span class="text-[10px] font-bold text-slate-500 uppercase">Recurring</span>
        </label>
      </div>
    </div>

    <div class="flex justify-end gap-2 pt-2">
      <button id="deleteCancelBtn" class="px-4 py-2 text-xs font-medium rounded-lg border border-slate-200 text-slate-600">Cancel</button>
      <button id="editSaveBtn" class="px-6 py-2 text-xs font-bold rounded-lg bg-slate-900 text-white shadow-sm">Save Changes</button>
    </div>
  </div>
</div>
</body>
</html>